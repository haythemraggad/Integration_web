<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details - Medicare+</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#10B981',
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="js/cart.js" defer></script>
    <script src="js/wishlist.js" defer></script>
    <script src="js/main.js" defer></script>
</head>
<body class="bg-white font-sans text-gray-800">
    <!-- Header -->
    <header class="container mx-auto py-4 px-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center">
                <a href="index.html">
                    <img src="img/logo.png" alt="Medicare+ Logo" class="h-7">
                </a>
            </div>
            <nav class="hidden md:flex space-x-6">
                <a href="index.html" class="text-gray-500 hover:text-green-500 flex items-center">
                    <i class="fas fa-home mr-1"></i>Home
                </a>
                <a href="service.html" class="text-gray-500 hover:text-green-500 flex items-center">
                    <i class="fas fa-concierge-bell mr-1"></i>Service
                </a>
                <a href="shop.html" class="text-gray-500 hover:text-green-500 flex items-center">
                    <i class="fas fa-store mr-1"></i>Shop
                </a>
                <a href="contact.html" class="text-gray-500 hover:text-green-500 flex items-center">
                    <i class="fas fa-phone-alt mr-1"></i>Contact
                </a>
            </nav>
            <div class="flex space-x-4">
                <div class="relative">
                    <a href="wishlist.html" class="bg-green-50 rounded-full p-2 flex items-center justify-center w-10 h-10 hover:bg-green-500 hover:text-white transition-colors duration-300">
                        <i class="fas fa-heart text-green-500 hover:text-white"></i>
                        <span class="wishlist-count absolute -top-1 -right-1 bg-green-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center">0</span>
                    </a>
                </div>
                <div class="relative">
                    <a href="cart.html" class="bg-green-50 rounded-full p-2 flex items-center justify-center w-10 h-10 hover:bg-green-500 hover:text-white transition-colors duration-300">
                        <i class="fas fa-shopping-cart text-green-500 hover:text-white"></i>
                        <span class="cart-count absolute -top-1 -right-1 bg-green-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center">0</span>
                    </a>
                </div>
                <a href="login.html" class="bg-green-50 rounded-full p-2 flex items-center justify-center w-10 h-10 hover:bg-green-500 hover:text-white transition-colors duration-300">
                    <i class="fas fa-user text-green-500 hover:text-white"></i>
                </a>
                <a href="#" class="bg-green-50 rounded-full p-2 flex items-center justify-center w-10 h-10 hover:bg-green-500 hover:text-white transition-colors duration-300">
                    <i class="fas fa-globe text-green-500 hover:text-white"></i>
                </a>
            </div>
        </div>
    </header>

    <!-- Product Details Section -->
    <section class="container mx-auto px-4 py-8">
        <div id="product-loading" class="text-center py-16">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"></div>
            <p class="mt-4 text-gray-600">Loading product details...</p>
        </div>
        
        <div id="product-details" class="hidden">
            <div class="flex flex-col md:flex-row">
                <div class="md:w-1/2 mb-6 md:mb-0">
                    <div class="mb-4">
                        <img id="product-main-image" src="" alt="Product Image" class="rounded-lg shadow-md w-full object-contain h-80">
                    </div>
                    <div id="product-thumbnails" class="flex space-x-2 overflow-x-auto pb-2">
                        <!-- Thumbnails will be added here -->
                    </div>
                </div>
                <div class="md:w-1/2 md:pl-8">
                    <h1 id="product-name" class="text-2xl font-bold text-gray-800 mb-2"></h1>
                    <p id="product-reference" class="text-sm text-gray-500 mb-4"></p>
                    
                    <div class="flex items-center mb-2">
                        <div id="product-rating" class="flex text-yellow-400 mr-2">
                            <!-- Stars will be added here -->
                        </div>
                        <span id="product-reviews" class="text-sm text-gray-500"></span>
                    </div>
                    
                    <div class="flex items-center mb-4">
                        <span id="product-price" class="text-green-600 font-bold text-xl mr-2"></span>
                        <span id="product-old-price" class="text-gray-400 line-through"></span>
                    </div>
                    
                    <p id="product-stock" class="text-sm font-medium mb-4"></p>
                    <p id="product-seller" class="text-sm text-gray-600 mb-4"></p>
                    
                    <p id="product-description" class="text-gray-600 mb-6"></p>
                    
                    <div class="flex space-x-4 mb-6">
                        <div class="w-24">
                            <label for="quantity" class="block text-sm font-medium text-gray-700 mb-1">Quantity</label>
                            <input type="number" id="quantity" min="1" value="1" class="w-full border border-gray-300 rounded px-3 py-2">
                        </div>
                        <div class="flex-1 flex space-x-2">
                            <button id="add-to-cart" class="flex-grow bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-colors duration-300">
                                Add to Cart
                            </button>
                            <button id="add-to-wishlist" class="bg-gray-100 text-gray-700 px-4 py-2 rounded hover:bg-gray-200 transition-colors duration-300 flex items-center justify-center">
                                <i class="fas fa-heart mr-2"></i> Wishlist
                            </button>
                        </div>
                    </div>
                    
                    <div id="product-features" class="mb-6">
                        <h3 class="font-medium mb-2">Key Features:</h3>
                        <ul class="list-disc list-inside space-y-1 text-gray-600">
                            <!-- Features will be added here -->
                        </ul>
                    </div>
                    
                    <div id="product-technical" class="mb-6">
                        <h3 class="font-medium mb-2">Technical Specifications:</h3>
                        <div class="space-y-1 text-gray-600">
                            <!-- Technical specs will be added here -->
                        </div>
                    </div>
                    
                    <div id="product-categories" class="flex flex-wrap gap-2">
                        <!-- Categories will be added here -->
                    </div>
                </div>
            </div>
        </div>
        
        <div id="related-products-section" class="mt-8 hidden">
            <h2 class="text-xl font-bold text-gray-800 mb-4">You May Also Like</h2>
            <div id="related-products" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Related Products will be dynamically inserted here -->
            </div>
        </div>
        
        <div id="product-error" class="hidden text-center py-16">
            <div class="text-red-500 text-xl mb-4">
                <i class="fas fa-exclamation-circle text-4xl mb-4 block"></i>
                Product Not Found
            </div>
            <p class="text-gray-600 mb-6">The product you're looking for could not be found.</p>
            <a href="shop.html" class="inline-block bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-colors duration-300">
                Return to Shop
            </a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="border-t mt-8 pt-8 pb-16">
        <div class="container mx-auto px-4">
            <div class="flex justify-between flex-col md:flex-row">
                <div class="mb-6 md:mb-0">
                    <div class="logo-container mb-4">
                        <img src="img/logo.png" alt="Medicare+ Logo" class="h-7">
                    </div>
                    <div class="footer-info space-y-2">
                        <div class="flex items-center">
                            <i class="fas fa-map-marker-alt text-green-500 mr-2"></i>
                            <span class="text-sm text-gray-600">Address</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-phone text-green-500 mr-2"></i>
                            <span class="text-sm text-gray-600">Call Us</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-envelope text-green-500 mr-2"></i>
                            <span class="text-sm text-gray-600">Email</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-clock text-green-500 mr-2"></i>
                            <span class="text-sm text-gray-600">Hours</span>
                        </div>
                    </div>
                </div>

                <div class="mb-6 md:mb-0">
                    <h3 class="font-medium mb-4">Account</h3>
                    <ul class="space-y-2">
                        <li><a href="login.html" class="text-sm text-gray-600 hover:text-green-500">Sign In</a></li>
                        <li><a href="#" class="text-sm text-gray-600 hover:text-green-500">View Cart</a></li>
                        <li><a href="wishlist.html" class="text-sm text-gray-600 hover:text-green-500">My Wishlist</a></li>
                        <li><a href="#" class="text-sm text-gray-600 hover:text-green-500">Track My Order</a></li>
                        <li><a href="#" class="text-sm text-gray-600 hover:text-green-500">Help Ticket</a></li>
                        <li><a href="#" class="text-sm text-gray-600 hover:text-green-500">Shipping Details</a></li>
                        <li><a href="#" class="text-sm text-gray-600 hover:text-green-500">Compare products</a></li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-medium mb-4">Install App</h3>
                    <p class="text-sm text-gray-600 mb-4">From App Store or Google Play</p>
                    <div class="flex space-x-2 mb-4">
                        <a href="#" class="inline-block">
                            <img src="img/app-store.png" alt="App Store" class="h-8">
                        </a>
                        <a href="#" class="inline-block">
                            <img src="img/google-play.png" alt="Google Play" class="h-8">
                        </a>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Follow Us</p>
                    <div class="flex space-x-2">
                        <a href="#" class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center">
                            <i class="fab fa-facebook-f text-white"></i>
                        </a>
                        <a href="#" class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center">
                            <i class="fab fa-twitter text-white"></i>
                        </a>
                        <a href="#" class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center">
                            <i class="fab fa-instagram text-white"></i>
                        </a>
                        <a href="#" class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center">
                            <i class="fab fa-youtube text-white"></i>
                        </a>
                        <a href="#" class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center">
                            <i class="fab fa-pinterest text-white"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Function to get URL parameters
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }
        
        // Function to generate star rating
        function generateStarRating(rating) {
            const fullStars = Math.floor(rating);
            const halfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
            
            let starsHTML = '';
            
            // Add full stars
            for (let i = 0; i < fullStars; i++) {
                starsHTML += '<i class="fas fa-star"></i>';
            }
            
            // Add half star if needed
            if (halfStar) {
                starsHTML += '<i class="fas fa-star-half-alt"></i>';
            }
            
            // Add empty stars
            for (let i = 0; i < emptyStars; i++) {
                starsHTML += '<i class="far fa-star"></i>';
            }
            
            return starsHTML;
        }
        
        // Function to load and display product details
        function loadProductDetails() {
            const productId = getUrlParameter('id');
            
            if (!productId) {
                document.getElementById('product-loading').classList.add('hidden');
                document.getElementById('product-error').classList.remove('hidden');
                return;
            }
            
            fetch('js/products.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(products => {
                    const product = products.find(p => p.id === productId);
                    
                    if (!product) {
                        document.getElementById('product-loading').classList.add('hidden');
                        document.getElementById('product-error').classList.remove('hidden');
                        return;
                    }
                    
                    // Display product details
                    document.getElementById('product-name').textContent = product.name;
                    document.getElementById('product-reference').textContent = `Reference: ${product.reference}`;
                    
                    // Set rating
                    document.getElementById('product-rating').innerHTML = generateStarRating(product.rating);
                    document.getElementById('product-reviews').textContent = `(${product.reviews} reviews)`;
                    
                    // Set prices
                    document.getElementById('product-price').textContent = `${product.currentPrice.toFixed(2)} ${product.currency}`;
                    if (product.oldPrice) {
                        document.getElementById('product-old-price').textContent = `${product.oldPrice.toFixed(2)} ${product.currency}`;
                    }
                    
                    // Set stock status
                    document.getElementById('product-stock').textContent = product.stock;
                    document.getElementById('product-stock').className = product.stock.toLowerCase().includes('in stock') 
                        ? 'text-sm font-medium mb-4 text-green-600' 
                        : 'text-sm font-medium mb-4 text-red-600';
                    
                    // Set seller
                    document.getElementById('product-seller').textContent = `Sold by: ${product.seller}`;
                    
                    // Set description
                    document.getElementById('product-description').textContent = product.description;
                    
                    // Set main image
                    document.getElementById('product-main-image').src = product.image;
                    document.getElementById('product-main-image').alt = product.name;
                    
                    // Set thumbnails
                    const thumbnailsContainer = document.getElementById('product-thumbnails');
                    thumbnailsContainer.innerHTML = '';
                    
                    if (product.images && product.images.length > 0) {
                        product.images.forEach(image => {
                            const thumbnail = document.createElement('div');
                            thumbnail.className = 'cursor-pointer border rounded p-1 hover:border-green-500';
                            thumbnail.innerHTML = `<img src="${image}" alt="${product.name}" class="h-16 w-16 object-contain">`;
                            
                            thumbnail.addEventListener('click', function() {
                                document.getElementById('product-main-image').src = image;
                            });
                            
                            thumbnailsContainer.appendChild(thumbnail);
                        });
                    }
                    
                    // Set features
                    const featuresContainer = document.getElementById('product-features').querySelector('ul');
                    featuresContainer.innerHTML = '';
                    
                    if (product.features && product.features.length > 0) {
                        product.features.forEach(feature => {
                            const featureItem = document.createElement('li');
                            featureItem.textContent = feature;
                            featuresContainer.appendChild(featureItem);
                        });
                    } else {
                        document.getElementById('product-features').classList.add('hidden');
                    }
                    
                    // Set technical specifications
                    const technicalContainer = document.getElementById('product-technical').querySelector('div');
                    technicalContainer.innerHTML = '';
                    
                    if (product.technical && Object.keys(product.technical).length > 0) {
                        for (const [key, value] of Object.entries(product.technical)) {
                            const techItem = document.createElement('div');
                            techItem.className = 'flex';
                            techItem.innerHTML = `
                                <span class="font-medium w-1/3 capitalize">${key}:</span>
                                <span class="w-2/3">${value}</span>
                            `;
                            technicalContainer.appendChild(techItem);
                        }
                    } else {
                        document.getElementById('product-technical').classList.add('hidden');
                    }
                    
                    // Set categories
                    const categoriesContainer = document.getElementById('product-categories');
                    categoriesContainer.innerHTML = '';
                    
                    if (product.categories && product.categories.length > 0) {
                        product.categories.forEach(category => {
                            const categoryTag = document.createElement('span');
                            categoryTag.className = 'bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded';
                            categoryTag.textContent = category;
                            categoriesContainer.appendChild(categoryTag);
                        });
                    }
                    
                    // Set up related products
                    if (product.related && product.related.length > 0) {
                        const relatedContainer = document.getElementById('related-products');
                        relatedContainer.innerHTML = '';
                        
                        product.related.forEach(related => {
                            const relatedCard = document.createElement('div');
                            relatedCard.className = 'product-card bg-white border rounded-lg p-4 hover:shadow-lg transform hover:-translate-y-1 transition-all duration-300';
                            
                            relatedCard.innerHTML = `
                                <div class="mb-4 flex justify-center overflow-hidden relative">
                                    <a href="product-details.html?id=${related.id}">
                                        <img src="${related.image}" alt="${related.name}" class="h-40 object-contain transform hover:scale-105 transition-transform duration-300">
                                    </a>
                                    <button class="wishlist-btn absolute top-2 right-2 bg-white rounded-full p-2 shadow-sm hover:shadow-md transition-all duration-200" data-product-id="${related.id}">
                                        <i class="fas fa-heart text-gray-400 hover:text-red-500"></i>
                                    </button>
                                </div>
                                <div class="text-center mb-2">
                                    <span class="product-price text-green-600 font-bold" data-price="${related.price}" data-currency="${related.currency}">${related.price.toFixed(2)} ${related.currency}</span>
                                    ${related.oldPrice ? `<span class="text-gray-400 line-through text-sm ml-2">${related.oldPrice.toFixed(2)} ${related.currency}</span>` : ''}
                                </div>
                                <div class="flex justify-end mb-2">
                                    <button class="add-to-cart-btn bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition-colors duration-300" data-product-id="${related.id}">Add to Cart</button>
                                </div>
                                <div>
                                    <h3 class="text-sm font-medium text-center">${related.name}</h3>
                                </div>
                            `;
                            
                            relatedContainer.appendChild(relatedCard);
                        });
                        
                        document.getElementById('related-products-section').classList.remove('hidden');
                        
                        // Initialize wishlist buttons for related products
                        if (typeof setupWishlistButtons === 'function') {
                            setupWishlistButtons();
                        }
                    }
                    
                    // Show product details
                    document.getElementById('product-loading').classList.add('hidden');
                    document.getElementById('product-details').classList.remove('hidden');
                    
                    // Setup add to cart button
                    document.getElementById('add-to-cart').addEventListener('click', function() {
                        const quantity = parseInt(document.getElementById('quantity').value) || 1;
                        
                        if (typeof addToCart === 'function') {
                            addToCart(product, quantity);
                            
                            // Show notification
                            const notification = document.createElement('div');
                            notification.className = 'fixed bottom-4 right-4 bg-green-500 text-white py-2 px-4 rounded-lg shadow-lg z-50';
                            notification.textContent = `${product.name} added to cart!`;
                            document.body.appendChild(notification);
                            
                            // Remove notification after 3 seconds
                            setTimeout(() => {
                                notification.remove();
                            }, 3000);
                        }
                    });
                    
                    // Setup add to wishlist button
                    const wishlistButton = document.getElementById('add-to-wishlist');
                    
                    // Check if product is already in wishlist
                    if (typeof isInWishlist === 'function') {
                        if (isInWishlist(product.id)) {
                            wishlistButton.classList.remove('bg-gray-100', 'text-gray-700');
                            wishlistButton.classList.add('bg-red-100', 'text-red-600');
                            wishlistButton.innerHTML = '<i class="fas fa-heart mr-2"></i> In Wishlist';
                        }
                    }
                    
                    wishlistButton.addEventListener('click', function() {
                        if (typeof isInWishlist === 'function' && typeof addToWishlist === 'function' && 
                            typeof removeFromWishlist === 'function') {
                            
                            if (isInWishlist(product.id)) {
                                // Remove from wishlist
                                if (removeFromWishlist(product.id)) {
                                    wishlistButton.classList.remove('bg-red-100', 'text-red-600');
                                    wishlistButton.classList.add('bg-gray-100', 'text-gray-700');
                                    wishlistButton.innerHTML = '<i class="fas fa-heart mr-2"></i> Wishlist';
                                    
                                    // Show notification
                                    const notification = document.createElement('div');
                                    notification.className = 'fixed bottom-4 right-4 bg-green-500 text-white py-2 px-4 rounded-lg shadow-lg z-50';
                                    notification.textContent = `${product.name} removed from wishlist!`;
                                    document.body.appendChild(notification);
                                    
                                    // Remove notification after 3 seconds
                                    setTimeout(() => {
                                        notification.remove();
                                    }, 3000);
                                }
                            } else {
                                // Add to wishlist
                                if (addToWishlist(product)) {
                                    wishlistButton.classList.remove('bg-gray-100', 'text-gray-700');
                                    wishlistButton.classList.add('bg-red-100', 'text-red-600');
                                    wishlistButton.innerHTML = '<i class="fas fa-heart mr-2"></i> In Wishlist';
                                    
                                    // Show notification
                                    const notification = document.createElement('div');
                                    notification.className = 'fixed bottom-4 right-4 bg-green-500 text-white py-2 px-4 rounded-lg shadow-lg z-50';
                                    notification.textContent = `${product.name} added to wishlist!`;
                                    document.body.appendChild(notification);
                                    
                                    // Remove notification after 3 seconds
                                    setTimeout(() => {
                                        notification.remove();
                                    }, 3000);
                                }
                            }
                        }
                    });
                })
                .catch(error => {
                    console.error('Error loading product details:', error);
                    document.getElementById('product-loading').classList.add('hidden');
                    document.getElementById('product-error').classList.remove('hidden');
                });
        }
        
        // Load product details when the page loads
        document.addEventListener('DOMContentLoaded', loadProductDetails);
    </script>
    
    <style>
        .animate-fade-in-out {
            animation: fadeInOut 3s ease-in-out;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(-20px); }
            10% { opacity: 1; transform: translateY(0); }
            90% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }
    </style>
</body>
</html>